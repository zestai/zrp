# ZRP unit testing
## Contains all the details about unit testing framework

![N|Solid]



Steps to follow

- Create a new environment 
- Use pip to install all dependencies using pip install -r requirements.txt
- All unit test data should be moved to tests folder before trigring the pipeline
- unit testing data is availabe in shared folder on given path shared/zrp/unit_test_data.zip :-
- for testing the framework
--- cp /d/shared/zrp/unit_test_data.zip.gz /home/{user_name}/zrp_old/tests/unit_test_data.zip.gz

unzip the data 
--- gzip -dv tests/unit_test_data.zip.gz  tests/unit_test_data.zip
--- unzip tests/unit_test_data.zip -d  tests

- Nevigate to zrp directory
- Run the unit test using "python -m tests.unit_test_prepare" 

 ✨Magic ✨

- You can run the unit testing module as many times as you want but, after completion, directory structure may not remain same hence avoid commiting any code to git as ./zrp/data directory will be affected while testing. 

-
## Features

- Is going to test all the modules used for data processing are working or not
- Is going to test wether the result generated by modules is correct or followes to the previous static release results


### Data Description 
- adding details about the data used for unit testing:


ACS_data directory: 
- Raw Data
1. A sample of 1 year American Community Survey data of 2019 for Alaska state,here are the name of files
    a. {e20191ak0148000.txt,e20191al0148000.txt} : Sample data files of ACS data, ACS data is provided within multipe files having state names and sequence number, these files are a sample data for alaska state.
    c. seq148.xlsx : this files contais schema of data for sequence number 148, basically used to provide column names to pandas dataframe.
    
    d. 1_year_Mini_Geo: geographical names and Geography ID for given state. Ex.
         
         
|      | State   |   Logical Record Number | Geography ID      | Geography Name         |
|----- |:-------:|:-----------------------:|:-----------------:|-----------------------:|
|    0 | US      |                       1 | 01000US           | United States          |
|    2 | US      |                       3 | 01043US           | United States -- Rural |
 

- Parsed Data
    a. Zest_ACS_nj_seq2_2019_1yr.parquet : A sample of processed 1-year American Community Survey data at the  level from the 2019 survey for state: NJ	GeoId: 04000US34	Geography Name:New Jersey
    b. processed_Zest_ACS_Lookup_20195yr_blockgroup.parquet:  processed 5-year American Community Survey data at the blockgroup level from the 2019 survey
    c. processed_Zest_ACS_Lookup_20195yr_tract.parquet: tract level processed 5-year American Community Survey data
    d. processed_Zest_ACS_Lookup_20195yr_zip.parquet: processed 5-year American Community Survey data at the zip  level from the 2019 survey 

- Geo Data
  Zest_Geo_Lookup_2019_State_34.parquet: Geo lookup sample data for New Jersey
  state_mapping.json: a json that maps state names and state FIPS codes to standardized abbreviations
  inv_state_mapping.json: a json that maps standardized abbreviations for state to a number. 
  
 - Processed_Zest_ACS_Lookup_20195yr_blockgroup.parquet: 
   a sample of processed 5-year American Community Survey data at the block group level from the 2019 survey
 
 - pipe.pkl: Pipeline file saved as pkl.
 
 - standard_population_weights.json: Population weightage by race for all states.
 - unit_test_results.parquet.gzip  : Ideal results for given parameters, There results are further used to perform unit testing and compare test results with ideal output.
 
 - models directory: contains trained 2019 models for block_group,zip level and census_tract levels.
 
 - Zest_Geo_Lookup_2019_01001.parquet:  Contains details about STATEFP,	COUNTYFP,	TRACTCE, BLKGRPCE mosting used for geotagging.

 - artifacts_static directory:
 contins validatin files for acs and geo data mostly does staic check if dataframe is not empty, all values are not NaNs 
  
- Zest_Geocoded__2019__34_1: Contains zeocoded data of New Jersey, sample having 565 rows and  23 columns, It is used to perform unit testing on geocoder module.
